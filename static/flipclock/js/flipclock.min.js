/*jshint smarttabs:true */var FlipClock;(function(e){"use strict";FlipClock=function(e,t,n){return new FlipClock.Factory(e,t,n)},FlipClock.Base=Base.extend({buildDate:"2013-04-16",version:"0.1.2",constructor:function(t,n){typeof t!="object"&&(t={}),typeof n!="object"&&(n={}),this.setOptions(e.extend(!0,{},t,n))},callback:function(e){if(typeof e=="function"){var t=[];for(var n=1;n<=arguments.length;n++)arguments[n]&&t.push(arguments[n]);e.apply(this,t)}},log:function(e){window.console&&console.log&&console.log(e)},getOption:function(e){return this[e]?this[e]:!1},getOptions:function(){return this},setOption:function(e,t){this[e]=t},setOptions:function(e){for(var t in e)typeof e[t]!="undefined"&&this.setOption(t,e[t])}}),FlipClock.Factory=FlipClock.Base.extend({autoStart:!0,callbacks:{destroy:!1,create:!1,init:!1,interval:!1,start:!1,stop:!1,reset:!1},classes:{active:"flip-clock-active",before:"flip-clock-before",divider:"flip-clock-divider",dot:"flip-clock-dot",label:"flip-clock-label",flip:"flip",play:"play",wrapper:"flip-clock-wrapper"},clockFace:"HourlyCounter",defaultClockFace:"HourlyCounter",face:!0,running:!1,time:!1,timer:!1,lists:[],$wrapper:!1,constructor:function(t,n,r){this.base(r),this.$wrapper=e(t).addClass(this.classes.wrapper),this.time=new FlipClock.Time(this,n?Math.round(n):0),this.timer=new FlipClock.Timer(this,r),this.face=this.loadClockFace(this.clockFace,r),this.autoStart&&this.start()},loadClockFace:function(e,t){var n;return e=e.ucfirst()+"Face",FlipClock[e]?n=new FlipClock[e](this,t):n=new FlipClock[this.defaultClockFace+"Face"](this,t),n.build(),n},start:function(e){var t=this;!t.running&&(!t.countdown||t.countdown&&t.time.time>0)?(t.face.start(t.time),t.timer.start(function(){t.flip(),typeof e=="function"&&e()})):t.log("Trying to start timer when countdown already at 0")},stop:function(e){this.face.stop(),this.timer.stop(e);for(var t in this.lists)this.lists[t].stop()},reset:function(e){this.timer.reset(e),this.face.reset()},setTime:function(e){this.time.time=e,this.face.setTime(e)},getTime:function(e){return this.time},setCountdown:function(e){var t=this.running;this.countdown=e?!0:!1,t&&(this.stop(),this.start())},flip:function(){this.face.flip()}}),FlipClock.Face=FlipClock.Base.extend({factory:!1,lists:[],constructor:function(e,t){this.base(t),this.factory=e},build:function(){},createDivider:function(t,n){var r=['<span class="'+this.factory.classes.dot+' top"></span>','<span class="'+this.factory.classes.dot+' bottom"></span>'].join("");n&&(r="");var i=['<span class="'+this.factory.classes.divider+" "+(t?t:"").toLowerCase()+'">','<span class="'+this.factory.classes.label+'">'+(t?t:"")+"</span>",r,"</span>"];return e(i.join(""))},createList:function(e,t){typeof e=="object"&&(t=e,e=0);var n=new FlipClock.List(this.factory,e,t);return n},reset:function(){},setTime:function(e){this.flip(e)},addDigit:function(e){var t=this.createList(e,{classes:{active:this.factory.classes.active,before:this.factory.classes.before,flip:this.factory.classes.flip}});t.$obj.insertBefore(this.factory.lists[0].$obj),this.factory.lists.unshift(t)},start:function(){},stop:function(){},flip:function(t,n){var r=this;n||(r.factory.countdown?(r.factory.time.time<=0&&r.factory.stop(),r.factory.time.time--):r.factory.time.time++);var i=r.factory.lists.length-t.length;i<0&&(i=0);var s=0,o=!1;e.each(t,function(e,t){e+=i;var s=r.factory.lists[e];if(s){var u=s.digit;s.select(t),t!=u&&!n&&s.play()}else r.addDigit(t),o=!0});for(var u=0;u<t.length;u++)u>=i&&r.factory.lists[u].digit!=t[u]&&r.factory.lists[u].select(t[u])}}),FlipClock.List=FlipClock.Base.extend({digit:0,classes:{active:"flip-clock-active",before:"flip-clock-before",flip:"flip"},factory:!1,$obj:!1,items:[],constructor:function(e,t,n){this.factory=e,this.digit=t,this.$obj=this.createList(),t>0&&this.select(t),this.factory.$wrapper.append(this.$obj)},select:function(e){typeof e=="undefined"?e=this.digit:this.digit=e;var t=this.$obj.find('[data-digit="'+e+'"]'),n=this.$obj.find("."+this.classes.active).removeClass(this.classes.active),r=this.$obj.find("."+this.classes.before).removeClass(this.classes.before);this.factory.countdown?t.is(":last-child")?this.$obj.find(":first-child").addClass(this.classes.before):t.next().addClass(this.classes.before):t.is(":first-child")?this.$obj.find(":last-child").addClass(this.classes.before):t.prev().addClass(this.classes.before),t.addClass(this.classes.active)},play:function(){this.$obj.addClass(this.factory.classes.play)},stop:function(){var e=this;setTimeout(function(){e.$obj.removeClass(e.factory.classes.play)},this.factory.timer.interval)},createList:function(){var t=e('<ul class="'+this.classes.flip+'" />');for(var n=0;n<10;n++){var r=e(['<li data-digit="'+n+'">','<a href="#">','<div class="up">','<div class="shadow"></div>','<div class="inn">'+n+"</div>","</div>",'<div class="down">','<div class="shadow"></div>','<div class="inn">'+n+"</div>","</div>","</a>","</li>"].join(""));this.items.push(r),t.append(r)}return t}}),FlipClock.Time=FlipClock.Base.extend({minimumDigits:0,time:0,factory:!1,constructor:function(e,t,n){this.base(n),this.factory=e,t&&(this.time=t)},convertDigitsToArray:function(e){var t=[];e=e.toString();for(var n=0;n<e.length;n++)e[n].match(/^\d*$/g)&&t.push(e[n]);return t},digit:function(e){var t=this.toString(),n=t.length;return t[n-e]?t[n-e]:!1},digitize:function(t){var n=[];return e.each(t,function(e,t){t=t.toString(),t.length==1&&(t="0"+t);for(var r=0;r<t.length;r++)n.push(t[r])}),n.length>this.minimumDigits&&(this.minimumDigits=n.length),this.minimumDigits>n.length&&n.unshift("0"),n},getDayCounter:function(){var e=this.digitize([this.getDays(),this.getHours(!0),this.getMinutes(!0),this.getSeconds(!0)]);return e},getDays:function(e){var t=this.time/60/60/24;return e&&(t%=7),Math.floor(t)},getHourCounter:function(){var e=this.digitize([this.getHours(),this.getMinutes(!0),this.getSeconds(!0)]);return e},getHourly:function(){return this.getHourCounter()},getHours:function(e){var t=this.time/60/60;return e&&(t%=24),Math.floor(t)},getMilitaryTime:function(){var e=new Date,t=this.digitize([e.getHours(),e.getMinutes(),e.getSeconds()]);return t},getMinutes:function(e){var t=this.time/60;return e&&(t%=60),Math.floor(t)},getMinuteCounter:function(){var e=this.digitize([this.getMinutes(!0),this.getSeconds(!0)]);return e},getSeconds:function(e){var t=this.time;return e&&(t==60?t=0:t%=60),Math.ceil(t)},getTime:function(){var e=new Date,t=e.getHours(),n=t>12?"PM":"AM",r=this.digitize([t>12?t-12:t===0?12:t,e.getMinutes(),e.getSeconds()]);return r},getWeeks:function(){var e=this.time/60/60/24/7;return mod&&(e%=52),Math.floor(e)},removeLeadingZeros:function(t,n){var r=0,i=[];return e.each(n,function(e,s){e<t?r+=parseInt(n[e],10):i.push(n[e])}),r===0?i:n},toString:function(){return this.time.toString()}}),FlipClock.Timer=FlipClock.Base.extend({callbacks:{destroy:!1,create:!1,init:!1,interval:!1,start:!1,stop:!1,reset:!1},count:0,factory:!1,interval:1e3,constructor:function(e,t){this.base(t),this.factory=e,this.callback(this.callbacks.init),this.callback(this.callbacks.create)},getElapsed:function(){return this.count*this.interval},getElapsedTime:function(){return new Date(this.time+this.getElapsed())},reset:function(e){clearInterval(this.timer),this.count=0,this._setInterval(e),this.callback(this.callbacks.reset)},start:function(e){this.factory.running=!0,this._createTimer(e),this.callback(this.callbacks.start)},stop:function(e){this.factory.running=!1,this._clearInterval(e),this.callback(this.callbacks.stop),this.callback(e)},_clearInterval:function(){clearInterval(this.timer)},_createTimer:function(e){this._setInterval(e)},_destroyTimer:function(e){this._clearInterval(),this.timer=!1,this.callback(e),this.callback(this.callbacks.destroy)},_interval:function(e){this.callback(this.callbacks.interval),this.callback(e),this.count++},_setInterval:function(e){var t=this;t.timer=setInterval(function(){t._interval(e)},this.interval)}}),String.prototype.ucfirst=function(){return this.substr(0,1).toUpperCase()+this.substr(1)},e.fn.FlipClock=function(t,n){return typeof t=="object"&&(n=t,t=0),new FlipClock(e(this),t,n)},e.fn.flipClock=function(t,n){return e.fn.FlipClock(t,n)}})(jQuery);