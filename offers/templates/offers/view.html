{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block title %}{{ offer.name }}{% endblock %}

{% block page_title %}
  {{ offer.name }}
  <a href="{% url 'offer:provider' offer.provider.pk %}"><small>{{ offer.provider.name }}</small></a>
{% endblock %}

{% block content %}
  {{ offer.content | safe }}
  <br />
  <p>
    <strong>{{ offer.provider.name }} TOS: </strong><a href="{{ offer.provider.tos }}">{{ offer.provider.tos }}</a>
  </p>
  <hr>
  <h2>Plans on offer:</h2>
  {% include 'offers/plan_set.html' with plan_set=offer.plan_set.all %}
  <h3>Locations:</h3>
  {% for location in offer.get_plan_locations %}
    {% include 'offers/location_detail.html' with location=location %}
  {% endfor %}
  <hr>
  <a name="comments"></a>
  <h2>Comments:</h2>
  {% include 'offers/comments.html' with comments=offer.get_comments %}
  {% if request.user.is_authenticated %}
    <h3>Add a comment</h3>
    {% crispy form %}
  {% endif %}
{% endblock %}

{% block extra_js %}
<script type="text/javascript">
  $(document).ready(function(){
    CKEDITOR.replace("comment", {
      toolbar: [
        { name: 'basicstyles', groups: [ 'basicstyles', 'cleanup' ], items: [ 'Bold', 'Italic', 'Strike', '-', 'RemoveFormat' ] },
        { name: 'clipboard', items: [ 'Cut', 'Copy', 'Paste', 'PasteText', 'PasteFromWord', '-', 'Undo', 'Redo' ] },
        { name: 'editing', groups: [ 'find', 'selection', 'spellchecker' ], items: [ 'Scayt' ] },
        { name: 'insert', items: [ 'SpecialChar' ] },
        { name: 'paragraph', groups: [ 'list', 'indent', 'blocks', 'align', 'bidi' ], items: [ 'NumberedList', 'BulletedList', '-', 'Outdent', 'Indent' ] }
      ]
  });
  });

  function setReply(comment_id){
    $("#id_reply_to").val(comment_id);
  }
</script>
{% endblock %}
